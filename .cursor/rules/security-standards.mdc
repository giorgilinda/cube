---
description: Critical security standards for React, TypeScript, and AI-generated code
globs: **/*
priority: high
---

# Security & Data Protection Doctrine

## 1. Zero-Trust for Input

- **Rule**: Never trust data from users, URLs, or external APIs.
- **Implementation**: Use **Zod** or **Valibot** to validate all incoming data shapes.
- **XSS**: Always use safe React patterns. Avoid `dangerouslySetInnerHTML` unless sanitized with `dompurify`.

## 2. Secrets & Environment

- **Rule**: NEVER hardcode API keys, tokens, or secrets.
- **Detection**: If you see a string that looks like a key (e.g., `sk_...`), stop and ask the user to move it to a `.env` file.
- **AI Safety**: Do not suggest "placeholder" keys that could be leaked to Git.

## 3. Supply Chain Security (Anti-Hallucination)

- **Rule**: Before suggesting a new npm package, verify it exists and is reputable.
- **Slopsquatting**: Watch out for "hallucinated" packages that don't exist; attackers often register these names with malicious code.

## 4. Modern React Security (2026 Standards)

- **RSC Security**: Ensure `use server` functions explicitly validate user permissions.
- **Data Leaks**: Avoid passing entire database objects to the client. Use "Data Transfer Objects" (DTOs) to pick only necessary fields.

## 5. Defense Patterns

- **CSRF**: Ensure all state-changing requests use CSRF tokens or SameSite cookie policies.
- **Authentication**: Prefer industry-standard libraries (Auth.js, Clerk, Kinde) over custom auth logic.
